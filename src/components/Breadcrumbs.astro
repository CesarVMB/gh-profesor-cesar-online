---
import menu from '../data/mainmenu.json';

const {
  extraItems = [],
  categorySlug = null, // üëà NUEVO
  tag = null,            // üëà NUEVO (para etiquetas)
} = Astro.props;

const pathname = Astro.url.pathname;

// Inicio
const breadcrumbs = [];
const home = menu.find(item => item.url === '/');
if (home) breadcrumbs.push(home);

// 1Ô∏è‚É£ Categor√≠a expl√≠cita (para posts)
if (categorySlug) {
  const categoryItem = menu.find(item =>
    item.url.startsWith(`/categoria/${categorySlug}`)
  );

  if (categoryItem) {
    breadcrumbs.push(categoryItem);
  }
}
// 2Ô∏è‚É£ Etiquetas
else if (tag) {
  breadcrumbs.push(
    { label: 'Etiquetas', url: '/etiquetas/1' },
    { label: tag }
  );
} 
// 2Ô∏è‚É£ Coincidencia autom√°tica (contacto, servicios, categor√≠as)
else {
  const matched = menu.find(
    item =>
      item.url !== '/' &&
      pathname === item.url
  );

  if (matched) breadcrumbs.push(matched);
}

// 3Ô∏è‚É£ Items din√°micos finales (post, tag, etc.)
breadcrumbs.push(...extraItems);
---

<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    {breadcrumbs.map((item, index) => (
      <li
        class={`breadcrumb-item ${
          index === breadcrumbs.length - 1 ? 'active' : ''
        }`}
        aria-current={index === breadcrumbs.length - 1 ? 'page' : undefined}
      >
        {item.url && index !== breadcrumbs.length - 1 ? (
          <a href={item.url}>{item.label}</a>
        ) : (
          item.label
        )}
      </li>
    ))}
  </ol>
</nav>

